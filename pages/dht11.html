<!--
=========================================================
* Soft UI Dashboard - v1.0.3
========================================================= 

* Product Page: https://www.creative-tim.com/product/soft-ui-dashboard
* Copyright 2021 Creative Tim (https://www.creative-tim.com)
* Licensed under MIT (https://www.creative-tim.com/license)

* Coded by Creative Tim

=========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
-->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="apple-touch-icon" sizes="76x76" href="../assets/img/logo-2.png">
  <link rel="icon" type="image/png" href="../assets/img/logo-2.png">
  <title>
    Soft UI Dashboard by Creative Tim
  </title>
  <!--     Fonts and icons     -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet" />
  <!-- Nucleo Icons -->
  <link href="../assets/css/nucleo-icons.css" rel="stylesheet" />
  <link href="../assets/css/nucleo-svg.css" rel="stylesheet" />
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
  <!-- Font Awesome Icons -->
  <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>
  <link href="../assets/css/nucleo-svg.css" rel="stylesheet" />
  <!-- CSS Files -->
  <link id="pagestyle" href="../assets/css/soft-ui-dashboard.css?v=1.0.3" rel="stylesheet" />
  <!-- Scroll Bar -->
  <!-- <link href="../assets/css/customScrollbar.css" rel="stylesheet" /> -->
  <link href="../assets/css//noScroll.css" rel="stylesheet" />
  <!-- toastr -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.4/toastr.css" rel="stylesheet" />
  <link href="../assets/css/custom-toastr.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.4/toastr.min.js"></script>
  <!-- data table -->
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.3/css/jquery.dataTables.css">
</head>

<body class="g-sidenav-show  bg-gray-100">
  <aside
    class="myDiv noscroll sidenav navbar navbar-vertical navbar-expand-xs border-0 border-radius-xl my-3 fixed-start ms-3 bg-light"
    id="sidenav-main">
    <div class="sidenav-header ms-3">
      <a class="navbar-brand m-0" href="../pages/dashboard.html">
        <img src="../image/homeiot.png" class="img-fluid" alt="main_logo">
        <span class="ms-1 font-weight-bold">My Dashboard</span>
      </a>
    </div>
    <hr class="horizontal dark mt-0">
    <div class="collapse navbar-collapse  noscroll  max-height-vh-100 h-100" id="sidenav-collapse-main">
      <ul class="navbar-nav">
        <li class="nav-item zoom">
          <a class="nav-link  active" href="../pages/dashboard.html">
            <div
              class="icon icon-shape text-center shadow border-radius-md me-2 d-flex align-items-center justify-content-center">
              <img src="../image/dashboard.png" class="img-fluid">
            </div>
            <span class="nav-link-text ms-1 font-weight-bold text-dark">Overview</span>
          </a>
        </li>
        <li class="nav-item zoom">
          <a class="nav-link" href="../pages/livingroom.html">
            <div
              class="icon icon-shape text-center shadow border-radius-md me-2 d-flex align-items-center justify-content-center">
              <img src="../image/sofa.png" class="img-fluid">
            </div>
            <span class="nav-link-text ms-1 font-weight-bold text-dark">Living Room</span>
          </a>
        </li>
        <li class="nav-item zoom">
          <a class="nav-link  " href="../pages/kitchen.html">
            <div
              class="icon icon-shape text-center shadow border-radius-md me-2 d-flex align-items-center justify-content-center">
              <img src="../image/kitchen.png" class="img-fluid">
            </div>
            <span class="nav-link-text ms-1 font-weight-bold text-dark">Kitchen</span>
          </a>
        </li>
        <li class="nav-item zoom">
          <a class="nav-link  " href="../pages/bed1.html">
            <div
              class="icon icon-shape text-center shadow border-radius-md me-2 d-flex align-items-center justify-content-center">
              <img src="../image/bedroom1.png" class="img-fluid">
            </div>
            <span class="nav-link-text ms-1 font-weight-bold text-dark">Bedroom 1</span>
          </a>
        </li>
        <li class="nav-item zoom">
          <a class="nav-link  " href="../pages/bed2.html">
            <div
              class="icon icon-shape text-center shadow border-radius-md me-2 d-flex align-items-center justify-content-center">
              <img src="../image/bedroom2.png" class="img-fluid">
            </div>
            <span class="nnav-link-text ms-1 font-weight-bold text-dark">Bedroom 2</span>
          </a>
        </li>
        <li class="nav-item mt-3">
          <h6 class="ps-4 ms-2 text-uppercase text-xs font-weight-bolder text-dark">Account pages</h6>
        </li>
        <li class="nav-item zoom">
          <a class="nav-link" href="/log-out">
            <div
              class="icon icon-shape text-center shadow border-radius-md me-2 d-flex align-items-center justify-content-center">
              <img src="../image/logout.png" class="img-fluid">
            </div>
            <span class="nav-link-text ms-1 font-weight-bolder text-dark">Log Out</span>
          </a>
        </li>
      </ul>
    </div>
  </aside>
  <main class="main-content position-relative max-height-vh-100 h-100 mt-1 border-radius-lg ">
    <!-- Navbar -->
    <nav class="navbar navbar-main navbar-expand-lg px-0 mx-4 shadow-none border-radius-xl" id="navbarBlur"
      navbar-scroll="true">
      <div class="container-fluid py-1 px-3">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb bg-transparent mb-0 pb-0 pt-1 px-0 me-sm-6 me-5">
            <li class="breadcrumb-item text-sm"><a class="opacity-5 text-dark" href="javascript:;">Pages</a></li>
            <li class="breadcrumb-item text-sm text-dark active" aria-current="page">Overview</li>
          </ol>
          <h6 class="font-weight-bolder mb-0">Overview </h6>
        </nav>
        <div class="collapse navbar-collapse mt-sm-0 mt-2 me-md-0 me-sm-4" id="navbar">
          <div class="ms-md-auto pe-md-3 d-flex align-items-center">
            <a class="nav-link text-body font-weight-bold px-0">
              <i class="bi bi-clock-fill"></i>
              <span class="d-sm-inline d-none ps-1 pe-1">Local Time:</span>
              <span class="d-sm-inline d-none" id="local-time"></span>
            </a>
          </div>
          <ul class="navbar-nav  justify-content-end">
            <li class="nav-item d-xl-none ps-3 d-flex align-items-center">
              <a href="javascript:;" class="nav-link text-body p-0" id="iconNavbarSidenav">
                <div class="sidenav-toggler-inner">
                  <i class="sidenav-toggler-line"></i>
                  <i class="sidenav-toggler-line"></i>
                  <i class="sidenav-toggler-line"></i>
                </div>
              </a>
            </li>
            <li class="nav-item dropdown pe-2 ps-3 d-flex align-items-center">
              <a href="javascript:;" class="nav-link text-body p-0 font-weight-bold" data-bs-toggle="dropdown"
                id="dropdownSettingBtn">
                <i class="fa fa-cog fixed-plugin-button-nav cursor-pointer"></i>
                <span class="d-sm-inline d-nonep ps-1">Cài Đặt</span>
              </a>
              <ul class="dropdown-menu dropdown-menu-end px-2 py-2 me-sm-n4 border border-primary"
                aria-labelledby="dropdownMenuButton">
                <li class="mb-2 mt-2 font-weight-bold text-center">Đặt ngưỡng</li>
                <li class="dropdown-item border-radius-md">
                  <form id="dropdownSettingMenu">
                    <h6 class="text-sm font-weight-bold">Nhiệt độ</h6>
                    <input class="form-control form-control-sm mb-2" type="number" onfocus="this.value=''"
                      placeholder="đặt ngưỡng" id="max-temper">
                    <h6 class="text-sm font-weight-bold">Độ ẩm</h6>
                    <input class="form-control form-control-sm mb-2" type="number" onfocus="this.value=''"
                      placeholder="đặt ngưỡng" id="max-humi">
                    <h6 class="text-sm font-weight-bold">Co2</h6>
                    <input class="form-control form-control-sm mb-2" type="number" onfocus="this.value=''"
                      placeholder="đặt ngưỡng" id="max-co2">
                    <h6 class="text-sm font-weight-bold">Gas</h6>
                    <input class="form-control form-control-sm mb-2" type="number" onfocus="this.value=''"
                      placeholder="đặt ngưỡng" id="max-gas">
                    <h6 class="text-sm font-weight-bold">Dust</h6>
                    <input class="form-control form-control-sm mb-2" type="number" onfocus="this.value=''"
                      placeholder="đặt ngưỡng" id="max-dust">
                    <button type="button" class="btn btn-sm bg-gradient-success mt-2 ms-2"
                      id="setting_btn">Accept</button>
                  </form>
                </li>
              </ul>
            </li>

            <li class="nav-item dropdown pe-2 ps-3 d-flex align-items-center">
              <a href="javascript:;" class="nav-link text-body p-0 font-weight-bold" id="dropdownNotifiButton"
                data-bs-toggle="dropdown" aria-expanded="false">
                <i class="fa fa-bell cursor-pointer"></i>
                <span class="d-sm-inline d-none ps-1">Thông Báo</span>
              </a>
              <ul class="dropdown-menu dropdown-menu-end px-2 py-2 me-sm-n4 border border-primary"
                aria-labelledby="dropdownMenuButton">
                <li class="mb-2 mt-2 font-weight-bold text-center">Lịch sử quá ngưỡng</li>
                <li class="mb-2">
                  <a class="dropdown-item border-radius-md" href="javascript:;">
                    <div class="d-flex py-1">
                      <div class="my-auto">
                        <img src="../image/temperature.png" class="avatar avatar-sm  me-3 ">
                      </div>
                      <div class="d-flex flex-column justify-content-center">
                        <h6 class="text-sm font-weight-normal mb-1">
                          <span class="font-weight-bold pe-2">Nhiệt độ: </span>
                          <span id="temper_history"></span>
                        </h6>
                        <p class="text-xs text-secondary mb-0">
                          <i class="fa fa-clock me-1"></i>
                          <span id="temper_history_time"></span>
                        </p>
                      </div>
                    </div>
                  </a>
                </li>
                <li class="mb-2">
                  <a class="dropdown-item border-radius-md" href="javascript:;">
                    <div class="d-flex py-1">
                      <div class="my-auto">
                        <img src="../image/humidity.png" class="avatar avatar-sm  me-3 ">
                      </div>
                      <div class="d-flex flex-column justify-content-center">
                        <h6 class="text-sm font-weight-normal mb-1">
                          <span class="font-weight-bold pe-2">Độ ẩm: </span>
                          <span id="humi_history"></span>
                        </h6>
                        <p class="text-xs text-secondary mb-0">
                          <i class="fa fa-clock me-1"></i>
                          <span id="humi_history_time"></span>
                        </p>
                      </div>
                    </div>
                  </a>
                </li>
                <li class="mb-2">
                  <a class="dropdown-item border-radius-md" href="javascript:;">
                    <div class="d-flex py-1">
                      <div class="my-auto">
                        <img src="../image/co2.png" class="avatar avatar-sm  me-3 ">
                      </div>
                      <div class="d-flex flex-column justify-content-center">
                        <h6 class="text-sm font-weight-normal mb-1">
                          <span class="font-weight-bold pe-2">Co2: </span>
                          <span id="co2_history"></span>
                        </h6>
                        <p class="text-xs text-secondary mb-0">
                          <i class="fa fa-clock me-1"></i>
                          <span id="co2_history_time"></span>
                        </p>
                      </div>
                    </div>
                  </a>
                </li>
                <li class="mb-2">
                  <a class="dropdown-item border-radius-md" href="javascript:;">
                    <div class="d-flex py-1">
                      <div class="my-auto">
                        <img src="../image/gas.png" class="avatar avatar-sm  me-3 ">
                      </div>
                      <div class="d-flex flex-column justify-content-center">
                        <h6 class="text-sm font-weight-normal mb-1">
                          <span class="font-weight-bold pe-2">Gas: </span>
                          <span id="gas_history"></span>
                        </h6>
                        <p class="text-xs text-secondary mb-0">
                          <i class="fa fa-clock me-1"></i>
                          <span id="gas_history_time"></span>
                        </p>
                      </div>
                    </div>
                  </a>
                </li>
                <li class="mb-2">
                  <a class="dropdown-item border-radius-md" href="javascript:;">
                    <div class="d-flex py-1">
                      <div class="my-auto">
                        <img src="../image/dust.png" class="avatar avatar-sm  me-3 ">
                      </div>
                      <div class="d-flex flex-column justify-content-center">
                        <h6 class="text-sm font-weight-normal mb-1">
                          <span class="font-weight-bold pe-2">Dust: </span>
                          <span id="dust_history"></span>
                        </h6>
                        <p class="text-xs text-secondary mb-0">
                          <i class="fa fa-clock me-1"></i>
                          <span id="dust_history_time"></span>
                        </p>
                      </div>
                    </div>
                  </a>
                </li>

              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- End Navbar -->
    <div class="container-fluid py-4">
      <div class="row">
        <div class="col-lg-5  py-3 mb-lg-0 mb-4">
          <div class="card h-100" style="background: linear-gradient(to bottom, #ffffff 0%, #ccffff 100%);">
            <h6 style="text-align: center; " class="font-weight-bolder mb-0 py-3">History table</h6>
            <div class="px-3 pt-0 pb-3">
              <table id="myTable" class="table border border-5">
                <thead>
                  <tr>
                    <th class="text-uppercase text-xs font-weight-bolder opacity-8"
                      style="color: black; background-color: silver;text-align: center;">
                      Date</th>
                    <th class="text-uppercase text-xs font-weight-bolder opacity-8"
                      style="color: black; background-color: silver;text-align: center;">
                      Temp</th>
                    <th class="text-uppercase text-xs font-weight-bolder opacity-8"
                      style="color: black; background-color: silver;text-align: center;">
                      Humi</th>
                  </tr>
                </thead>
                <tbody>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="col-lg-7 py-3 mb-lg-0 mb-4">
          <div class="card h-100" style="background: linear-gradient(to bottom, #ffffff 0%, #ccffff 100%);">
            <h6 style="text-align: center; " class="font-weight-bolder mb-0 pt-3">Realtime Chart</h6>
            <h6 style="text-align: center; " class="font-weight-bolder mb-0" id="date"></h6>
            <div class="px-3 pt-0 pb-3" style="height: 430px;">
              <canvas id="myChart"></canvas>
            </div>
          </div>
        </div>
      </div>
      <footer class="footer pt-3  ">
        <div class="container-fluid">
          <div class="row align-items-center justify-content-lg-between">
            <div class="col-lg-6 mb-lg-0 mb-4">
              <div class="copyright text-center text-sm text-muted text-lg-start">
                ©
                <script>
                  document.write(new Date().getFullYear())
                </script>,
                made with <i class="fa fa-heart"></i> by
                <a href="https://www.creative-tim.com" class="font-weight-bold" target="_blank">Creative
                  Tim</a>
                for a better web.
              </div>
            </div>
            <div class="col-lg-6">
              <ul class="nav nav-footer justify-content-center justify-content-lg-end">
                <li class="nav-item">
                  <a href="https://www.creative-tim.com" class="nav-link text-muted" target="_blank">Creative Tim</a>
                </li>
                <li class="nav-item">
                  <a href="https://www.creative-tim.com/presentation" class="nav-link text-muted" target="_blank">About
                    Us</a>
                </li>
                <li class="nav-item">
                  <a href="https://creative-tim.com/blog" class="nav-link text-muted" target="_blank">Blog</a>
                </li>
                <li class="nav-item">
                  <a href="https://www.creative-tim.com/license" class="nav-link pe-0 text-muted"
                    target="_blank">License</a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </main>
  <!--   Core JS Files   -->
  <script src="../assets/js/core/popper.min.js"></script>
  <script src="../assets/js/core/bootstrap.min.js"></script>
  <script src="../assets/js/plugins/perfect-scrollbar.min.js"></script>
  <script src="../assets/js/plugins/smooth-scrollbar.min.js"></script>
  <!-- Github buttons -->
  <script async defer src="https://buttons.github.io/buttons.js"></script>
  <!-- Control Center for Soft Dashboard: parallax effects, scripts for the example pages etc -->
  <script src="../assets/js/soft-ui-dashboard.min.js?v=1.0.3"></script>
  <!-- Chart Js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.5.1/chart.min.js"></script>
  <!-- data Tables -->
  <script type="text/javascript" charset="utf8"
    src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.js"></script>
  <script src="https://cdn.datatables.net/plug-ins/1.11.3/pagination/input.js"></script>
  <!-- Socket IO -->
  <script src="/socket.io/socket.io.js"></script>

  <!-- local time -->
  <script>
    const socket = io();
    setInterval(function () {
      var whatTimeIsThis = new Date()
      whatTimeIsThis = whatTimeIsThis.toString().slice(4, 24);
      document.getElementById("local-time").innerHTML = whatTimeIsThis
    }, 1000)
  </script>
  <!-- Tables -->
  <script>
    // var table;
    init_table();

    socket.on("sensor-data-table", function (data) {
      //detroy to recreate
      if ($.fn.DataTable.isDataTable("#myTable")) {
        $("#myTable").DataTable().clear().destroy();
      }
      for (let i in data) {
        $('#myTable').append('<tr> <td class="table-light text-center" ><h6>' + data[i].Time + '</h6> </td> <td class="table-success text-center"> <h6>' + data[i].Temper + '</h6> </td><td class="table-info text-center"> <h6>' + data[i].Humi + '</h6> </td> </tr>');
      }
      init_table();
    });

    function init_table() {
      $('#myTable').DataTable({
        // retrieve: true,
        autoWidth: false,
        pageLength: 8,
        lengthChange: false,
        info: false,
        pagingType: "input",
        //drawCallback that is called every time DataTables performs a draw.
        drawCallback: function () {
          $('td').css({ 'padding-top': '1px', 'padding-bottom': '1px'});
        },
        order: [[0, "desc"], [1, "desc"], [2, "desc"]]//dao nguoc hang theo cot
      });
      $('.dataTables_filter input[type="search"]').css(
        { 'width': '150px', 'border-collapse': 'collapse', 'border-radius': '8px' }
      );
      $('#myTable_first').hide();
      $('#myTable_page').hide();
      $('#myTable_last').hide();
      $('.paginate_input').attr('size', 2);
      $('#myTable_paginate').css({ 'font-size': '13px', 'font-weight': 'bold' });
    }
  </script>
  
  <!-- Chart Analysis -->
  <script>
    $(document).ready(function () {
      var ctx = document.getElementById('myChart');
      var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: [],
          datasets: [
            {
              label: "Temperature",
              backgroundColor: "#ff9933",
              data: []
            }, {
              label: "Humidity",
              backgroundColor: "#33ccff",
              data: []
            }
          ]
        },
        options: {
          title: {
            display: true,
            text: 'Temperature & Humidity'
          },
          responsive: true,
          maintainAspectRatio: false
        }
      });

      socket.on("sensor-data-chart", function (result) {//result is array containing each row as an object
        // console.log(data);
        document.getElementById("date").innerHTML = "(" + result[0].Time.slice(0, 10) + ")";
        for (let i = 0; i < result.length; i++) {
          myChart.data.datasets[0].data[i] = result[i].Temper;
          myChart.data.datasets[1].data[i] = result[i].Humi;
          myChart.data.labels[i] = result[i].Time.slice(11, 19);
        }
        myChart.update();
      });
    });
  </script>

  <!-- module xu ly thong bao va cai dat nguong -->
  <script>
    //toastr init
    toastr.options = {
      "closeButton": true,
      "debug": true,
      "newestOnTop": true,
      "progressBar": true,
      "positionClass": "toast-top-right",
      "preventDuplicates": true,
      "onclick": null,
      "showDuration": "300",
      "hideDuration": "5000",
      "timeOut": "5000",
      "extendedTimeOut": "1000",
      "showEasing": "swing",
      "hideEasing": "linear",
      "showMethod": "fadeIn",
      "hideMethod": "fadeOut"
    }
    //show lịch sử thông báo, dropdown notifi menu
    var history_temper_value = document.getElementById("temper_history");
    var history_temper_time = document.getElementById("temper_history_time");

    var history_humi_value = document.getElementById("humi_history");
    var history_humi_time = document.getElementById("humi_history_time");

    var history_co2_value = document.getElementById("co2_history");
    var history_co2_time = document.getElementById("co2_history_time");

    var history_gas_value = document.getElementById("gas_history");
    var history_gas_time = document.getElementById("gas_history_time");

    var history_dust_value = document.getElementById("dust_history");
    var history_dust_time = document.getElementById("dust_history_time");

    //cap nhat gia tri dropdown notifi menu
    document.getElementById("dropdownNotifiButton").addEventListener("click", function () {
      socket.emit("notifi_onclick", "trigger");
    });
    socket.on("update_notifi", function (data) {
      history_temper_value.innerHTML = data.Temper.value + '<span class="text-success text-sm font-weight-bolder ps-1">&degC</span>';
      history_temper_time.innerHTML = data.Temper.time;

      history_humi_value.innerHTML = data.Humi.value + '<span class="text-success text-sm font-weight-bolder ps-1">%</span>';
      history_humi_time.innerHTML = data.Humi.time;

      history_co2_value.innerHTML = data.Co2.value + '<span class="text-success text-sm font-weight-bolder ps-1">PPM</span>';
      history_co2_time.innerHTML = data.Co2.time;

      history_gas_value.innerHTML = data.Gas.value + '<span class="text-success text-sm font-weight-bolder ps-1">PPM</span>';
      history_gas_time.innerHTML = data.Gas.time;

      history_dust_value.innerHTML = data.Dust.value + '<span class="text-success text-sm font-weight-bolder ps-1">ug/m3</span>';
      history_dust_time.innerHTML = data.Dust.time;
    });

    //--------------xử lý giá trị đặt ngưỡng--------------------------------
    //onload sẽ cập nhật giá trị ngưỡng cũ từ database vào list dưới đây
    var setting_menu = document.getElementById("dropdownSettingMenu").elements;
    var setting_list = { "Temper": 0, "Humi": 0, "Co2": 0, "Gas": 0, "Dust": 0 };

    //cap nhat gia tri setting menu
    var setting_btn_dropdown = document.getElementById("dropdownSettingBtn");
    setting_btn_dropdown.addEventListener("click", function () {
      socket.emit("dropdownSettingMenu_onlick", "trigger");
    });

    socket.on("update_setting", function (data) {
      // console.log(data);
      setting_menu.namedItem("max-temper").value = data.Temper;
      setting_menu.namedItem("max-humi").value = data.Humi;
      setting_menu.namedItem("max-co2").value = data.Co2;
      setting_menu.namedItem("max-gas").value = data.Gas;
      setting_menu.namedItem("max-dust").value = data.Dust;
      setting_list.Temper = data.Temper;
      setting_list.Humi = data.Humi;
      setting_list.Co2 = data.Co2;
      setting_list.Gas = data.Gas;
      setting_list.Dust = data.Dust;
    });


    var submit_btn = document.getElementById("setting_btn");
    submit_btn.addEventListener("click", function () {
      if (setting_menu.namedItem("max-temper").value > 0)
        //nếu giá trị cài ngưỡng mới thỏa mãn đk thì update vào list
        setting_list.Temper = setting_menu.namedItem("max-temper").value;

      if (setting_menu.namedItem("max-humi").value > 0)
        setting_list.Humi = setting_menu.namedItem("max-humi").value;

      if (setting_menu.namedItem("max-co2").value > 0)
        setting_list.Co2 = setting_menu.namedItem("max-co2").value;

      if (setting_menu.namedItem("max-gas").value > 0)
        setting_list.Gas = setting_menu.namedItem("max-gas").value;

      if (setting_menu.namedItem("max-dust").value > 0)
        setting_list.Dust = setting_menu.namedItem("max-dust").value;

      socket.emit("change-setting", setting_list);
    });

    //hiển thị thông báo khi vượt ngưỡng cài đặt, mỗi lần server nhận đc dữ liệu mới từ cảm biến
    var notification = false;
    socket.on("notifi_mode", function (data) {
      console.log(data);
      if (data == "on")
        notification = true;
      else
        notification = false;
    });

    //dam bao sau khi mode variable da dc load
    $(document).ready(function () {
      socket.on("show_toastr", function (data) {
        if (notification) {
          if (data.Temper >= setting_list.Temper)
            toastr["success"](data.Temper + ' °C', "Nhiệt độ", { "iconClass": 'customer-temper' });

          if (data.Humi >= setting_list.Humi)
            toastr["success"](data.Humi + ' %', "Độ ẩm", { "iconClass": 'customer-humi' });

          if (data.Co2 >= setting_list.Co2)
            toastr["success"](data.Co2 + ' PPM', "Co2", { "iconClass": 'customer-co2' });

          if (data.Gas >= setting_list.Gas)
            toastr["success"](data.Gas + ' PPM', "Gas", { "iconClass": 'customer-gas' });

          if (data.Dust >= setting_list.Dust)
            toastr["success"](data.Dust + ' ug/m3', "Dust", { "iconClass": 'customer-dust' });
        }
      });
    });
  </script>
</body>

</html>